<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0 user-scalable=no">
    <title>População Estimada RMGV</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" 
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" 
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <script src="dados/populacao.js"></script>
</head>
<body>
    <div id="mapa"></div>

    <!-- Leaflet -->

    <script>
         const lat = -20.271926, lng = -40.325852
         const zoom = 10

        var map = L.map("mapa", {
            zoomSnap: 0.25
        }).setView([lat,lng], zoom)

        // posicionar base somente labels sobre a camada sem label
        map.createPane('labels')
        map.getPane('labels').style.zIndex = 650
        map.getPane('labels').style.pointerEvents = 'none'
        
        // base sem labels
        var CartoDB_PositronNoLabels = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {
	    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	    subdomains: 'abcd',
	    maxZoom: 20
        }).addTo(map)

        // base somente labels
        var CartoDB_PositronOnlyLabels = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png', {
	    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	    subdomains: 'abcd',
	    maxZoom: 20,
        pane: 'labels'
        })
        
        var municipios = L.geoJSON(municipios, {
            style:getStyle
        }).bindTooltip(function(layer){
            return `<strong>${layer.feature.properties.NOME}</strong>`
        }).addTo(map)

        function getColor(pop) {
            return pop > 525000 ? '#67001f':
                   pop > 500000 ? '#980043':
                   pop > 380000 ? '#ce1256':
                   pop > 360000 ? '#e7298a':
                   pop > 125000 ? '#df65b0':
                   pop > 750000 ? '#c994c7':
                   pop > 200000 ? '#e7e1ef':
                                  '#f7f4f9'
        }       

        function getStyle(feature) {
            return {
                fillColor: getColor(feature.properties.POPULACAO),
                fillOpacity: 0.7,
                color: '#67001f',
                weight: 2,
                opacity: 0.3
            }
        }

    </script>
</body>
</html>